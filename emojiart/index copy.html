<!DOCTYPE html>
<!--
⢠⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣄⣀⣀⠄⠄⠄⠄⠄⠄⠄⠄⣀⣀⣀⣀⣀⣀⣀⡀
⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣆⡀⠄⠄⠄⠄⠿⠿⠿⠿⢿⣿⣿⠇
⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⠄⠄⠄⠄⠄⠄⠄⣠⣿⡿⠁⠄
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠄⠄⠄⠈⠹⣿⣿⣿⣿⣧⠄⠄⠄⠄⠄⣰⣿⡿⠁⠄⠄
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠄⠄⠄⠄⠄⣿⣿⣿⣿⣿⠄⠄⠄⠄⢀⣿⣿⠇⠄⠄⠄
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠄⠄⠄⠄⢀⣿⣿⣿⣿⡟⠄⠄⠄⠄⠘⠛⠛⢀⣀⣀⠄
⢸⣿⣿⣿⣿⣤⣤⣤⣤⣤⣤⣤⣶⣾⣿⣿⣿⡿⠄⠄⠄⠄⠄⠄⢀⣴⣿⣿⣿⠄
⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⠄⠄⠄⠄⠄⠄⣠⣿⠟⢹⣿⣿⠄
⢸⣿⣿⣿⣿⠿⠿⠿⣿⣿⣿⣿⣯⣍⠁⠄⠄⠄⠄⠄⠄⢀⣾⣿⣉⣀⣸⣿⣿⣀
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠙⢿⣿⣿⣿⣷⣄⠄⠄⠄⠄⠄⠸⠿⠿⠿⠿⢿⣿⣿⠿
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠄⠈⣿⣿⣿⣿⣿⣆⠄⠄⠄⠄⠄⠄⠄⠄⠄⠸⠿⠿⠄
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠄⠄⠈⢿⣿⣿⣿⣿⣇⠄⠄⠄⠄⣿⣿⣧⣾⣿⣿⣷⡀
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠄⠄⠄⠈⢻⣿⣿⣿⣿⣦⠄⠄⠄⣿⣿⡏⠄⢸⣿⣿⡇
⢸⣿⣿⣿⣿⠄⠄⠄⠄⠄⠄⠄⠄⠄⢿⣿⣿⣿⣿⣆⠄⠄⣿⣿⡇⠄⢸⣿⣿⡇
⠘⠛⠛⠛⠛⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠛⠛⠛⠛⠛⠃⠄⠛⠛⠃⠄⠘⠛⠛⠃
This HTML and its contents are property of R74n.com.
-->

<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="Draw pixel art-like text art using emojis">
    <meta name="keywords" content="R74n, ryan, RyanUwU, slweeb, pixel art, emoji, unicode, text art, ascii art, generator">
    <meta name="author" content="R74n">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="twitter:image:alt" content="R74n">
    <title>Emoji Art Canvas - R74n</title>
    <link rel="stylesheet" type="text/css" href="../stylesheet.css"/>
    <link rel="stylesheet" type="text/css" href="../normalize.css"/>
    <link rel="apple-touch-icon" sizes="180x180" href="https://R74n.com/icons/apple-touch-icon.png?v=R74n-2">
    <link rel="icon" type="image/png" sizes="32x32" href="https://R74n.com/icons/favicon-32x32.png?v=R74n-2">
    <link rel="icon" type="image/png" sizes="16x16" href="https://R74n.com/icons/favicon-16x16.png?v=R74n-2">
    <link rel="manifest" href="https://R74n.com/icons/site.webmanifest?v=R74n-2">
    <link rel="mask-icon" href="https://R74n.com/icons/safari-pinned-tab.svg?v=R74n-2" color="#1cd2d2">
    <link rel="shortcut icon" href="https://R74n.com/icons/favicon.ico?v=R74n-2">
    <meta name="msapplication-TileColor" content="#00ffff">
    <meta name="msapplication-config" content="https://R74n.com/icons/browserconfig.xml?v=R74n-2">
    <meta name="theme-color" content="#000000">
    <style>
      .emojibtn {
        transition: .2s
      }
      .emojibtn:hover, .emojibtn[clicked=true] {transform: scale(1.5);margin-left:10px;margin-right:10px;font-size:25px}
      #Canvas {-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}
    </style>
    <script src="https://R74n.com/load.js"></script>
    <script src="lzutf8.js"></script>
    <script>
      emojis = {
        "➖":"#404040",
        "⬛️":"#333333",
        "⬜️":"#ffffff",
        "🟥":"#ff0000",
        "🟧":"#ff9300",
        "🟨":"#fffb00",
        "🟩":"#00f900",
        "🟦":"#0433ff",
        "🟪":"#ff40ff",
        "🟫":"#aa7942",
        "🎛":"#c2c3c3",
        "🔳":"#8a8a8a",
        "🔲":"#b5b5b5",
        "ℹ️":"#5eb0b0",
        "👁":"#9a6509",
      }
      currentemoji = "➖";
      function setEmoji(emoji) {
        if (emoji==currentemoji) {return}
        var element = document.getElementById(emoji);
        element.setAttribute("clicked","true");
        var oldelement = document.getElementById(currentemoji);
        oldelement.removeAttribute("clicked");
        currentemoji = emoji;
      }
      function linesStartWith(text,string) {
        var lines = text.split("\n");
        for (var i=0;i<lines.length;i++) {
          var line = lines[i];
          if (!(line.startsWith(string))) {return false}
        }
        return true
      }
      function clearLineStarts(text,string) {
        while (linesStartWith(text,string)) {
          var lines = text.split("\n");
          var newlines = [];
          for (var i=0;i<lines.length;i++) {
            newlines.push(lines[i].substring(1))
          }
          text = newlines.join("\n");
        }
        return text
      }
      function generate() {
        document.getElementById("CopyButton").value = "Copy";
        var newtext = "";
        var b64list = [];
        var children = document.getElementById("Canvas").children;
        for (var i = 0; i < children.length; i++) {
          var pixel = children[i];
          if (pixel.tagName=="BR") {newtext += "\n"}
          else {newtext += pixel.innerHTML;
          b64list.push(pixel.innerHTML.toString())}
        }
        var lines = newtext.split("\n");
        var newlines = [];
        for (var i=0;i<lines.length;i++) {
          var line = lines[i];
          while (line.endsWith("➖")) {
            line = line.slice(0, -1)
          }
          newlines.push(line);
        }
        newtext = newlines.join("\n");
        window.history.replaceState(null, null, "?"+b64EncodeUnicode(canvassize[0]+"|"+canvassize[1]+"|"+b64list.join("—")+"|Untitled Piece").replaceAll("=","-"));
        while (newtext.endsWith("\n")) {newtext = newtext.slice(0, -1)}
        while (newtext.startsWith("\n")) {newtext = newtext.substring(1)}
        newtext = clearLineStarts(newtext,"➖");
        var GeneratedText = document.getElementById("GeneratedText");
        GeneratedText.innerHTML = newtext;
        GeneratedText.select();
        document.getElementById("Generated").style.display = "block";
        var GeneratedLink = document.getElementById("GeneratedLink");
        GeneratedLink.innerHTML = "https://R74n.com/emojiart/"+location.search
        GeneratedLink.setAttribute("href","https://R74n.com/emojiart/"+location.search)
        location.hash = "Generated";
        console.log(b64list)
      }
      function fill(emoji) {
        if (confirm("Are you sure you want to clear the entire canvas?")) {
          var children = document.getElementById("Canvas").children;
          for (var i = 0; i < children.length; i++) {
            var pixel = children[i];
            if (pixel.tagName=="SPAN") {pixel.innerHTML=emoji}
          }
        }
      }

      function resize(height,width,force=false) {
        if (force || confirm("Are you sure you want to clear the entire canvas?")) {
          canvassize = [width,height];
          var Canvas = document.getElementById("Canvas");
          document.getElementById("WidthBox").value = width;
          document.getElementById("HeightBox").value = height;
          Canvas.innerHTML = "";
          if (height>30) {height=30}
          else if (height<1) {height=1}
          if (width>30) {width=30}
          else if (width<1) {width=1}
          for (var x = 0; x<height; x++) {
            for (var y = 0; y<width; y++) {
              var element = document.createElement("span");
              element.innerHTML = "➖";
              element.setAttribute("id",x+"-"+y)
              element.setAttribute("draggable","true")
              element.style.cursor = "pointer";
              element.setAttribute("onclick","this.innerHTML=currentemoji;currentpos=this.id");
              element.setAttribute("ondragover","this.innerHTML=currentemoji;currentpos=this.id");
              Canvas.appendChild(element);
            }
            Canvas.innerHTML += "<br>"
          }
        }
      }
      var emojiStringToArray = function (str) {
        split = str.split(/([\uD800-\uDBFF][\uDC00-\uDFFF])/);
        arr = [];
        for (var i=0; i<split.length; i++) {
          char = split[i]
          if (char !== "") {
            arr.push(char);
          }
        }
        return arr;
      };
      function b64EncodeUnicode(str) {
          return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,
              function toSolidBytes(match, p1) {
                  return String.fromCharCode('0x' + p1);
          }));
      }
      function b64DecodeUnicode(str) {
          return decodeURIComponent(atob(str).split('').map(function(c) {
              return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
          }).join(''));
      }
      window.addEventListener("load",function() {
        location.hash = "";
        var EmojisBox = document.getElementById("EmojisBox");
        for (var emoji in emojis) {
          var color = emojis[emoji];
          var element = document.createElement("input");
          element.setAttribute("type","button");
          element.setAttribute("id",emoji);
          element.setAttribute("value",emoji);
          element.setAttribute("class","emojibtn");
          element.style.backgroundColor = color;
          element.setAttribute("onclick","setEmoji('"+emoji+"')");
          EmojisBox.appendChild(element);
        }
        setEmoji("⬛️");

        if (!(location.search=="")) {
          var ArtData = b64DecodeUnicode(location.search.substring(1).replaceAll("-","=")).split("|");
          console.log(ArtData);
          if (ArtData[2].startsWith("[")) {var pixels = JSON.parse(ArtData[2])}
          else {
            var pixels = ArtData[2].split("—");
          }
          resize(parseInt(ArtData[0]),parseInt(ArtData[1]),force=true);
          console.log(pixels)
          var count = 0;
          for (var y=0; y<canvassize[1]; y++) {
            for (var x=0; x<canvassize[0]; x++) {
              var e = document.getElementById(y+"-"+x);
              e.innerHTML = pixels[count]
              count++
            }
          }


        }
        else {resize(8,8,true);}
      })
    </script>

    <script src="https://R74n.com/moji/load.js"></script>

</head>

<body>


<a href="https://R74n.com" class="backbutton">⦉</a>
<h1 class="pagetitle">Emoji Art Canvas</h1><br>
<div class="content">


<div id="ControlsBox" style="padding-bottom:20px;">
<div style="display:inline-block">
  <input type="button" value="Generate" onclick="generate();">
  <input type="button" value="Fill" onclick="fill(currentemoji);">
  <input type="button" value="Clear" onclick="fill('➖');">
</div>
<div style="display:inline-block">
  <input title="Enter Width" id="WidthBox" type="number" max="30" placeholder="Width" value="8" min="1">
  x
  <input title="Enter Height" id="HeightBox" type="number" max="30" placeholder="Height" value="8" min="1">
  <input type="button" value="Reset and Resize" onclick="resize(parseInt(document.getElementById('HeightBox').value),parseInt(document.getElementById('WidthBox').value))">
</div>
<!--
  Fill
  Clear
  
-->
</div>
<div id="EmojisBox" style="padding-bottom:20px;"></div>
<div id="Canvas" style="padding-bottom:20px;font-size:40px;line-height:1;white-space:nowrap;width:auto;display:block;overflow-x:scroll;overflow-y:hidden"></div>

<div id="Generated" style="display:none">
<textarea id="GeneratedText" style="margin-bottom:20px;display:block;height:300px;width:300px;"></textarea>
<input type="button" value="Generate" onclick="generate();">
<input type="button" value="Copy" onclick="document.getElementById('GeneratedText').select();document.execCommand('copy');this.value='Copied'" id="CopyButton">
<br><br>
You can also share this URL with anyone and they can edit it:<br>
<a id="GeneratedLink" href=""></a>
</div>




</div>




<!-- i like having this but ublock blocks these things anyway -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-93720349-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93720349-6');
</script>



</body>
</html>
